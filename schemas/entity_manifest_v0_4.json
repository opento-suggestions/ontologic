{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://ontologic.network/schemas/entity_manifest_v0_4.json",
  "title": "Entity Manifest Schema v0.4",
  "description": "Canonical manifest format for Floridi (entity) proof with domain projections",
  "type": "object",
  "required": [
    "v",
    "layer",
    "token",
    "controller",
    "owner",
    "projections",
    "topicId",
    "ts",
    "signer"
  ],
  "properties": {
    "v": {
      "type": "string",
      "const": "0.4",
      "description": "Schema version"
    },
    "layer": {
      "type": "string",
      "const": "floridi",
      "description": "Epistemic layer: floridi (entity/governance)"
    },
    "token": {
      "type": "object",
      "required": ["id", "symbol"],
      "description": "Token identification",
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^0\\.0\\.[0-9]+$",
          "description": "Hedera token ID (e.g., '0.0.7204602')"
        },
        "symbol": {
          "type": "string",
          "description": "Token symbol (e.g., 'PURPLE')"
        },
        "name": {
          "type": "string",
          "description": "Optional token name"
        }
      }
    },
    "controller": {
      "type": "string",
      "pattern": "^0x[0-9a-fA-F]{40}$",
      "description": "EVM address of entity controller"
    },
    "owner": {
      "type": "string",
      "description": "Owner identifier or address"
    },
    "projections": {
      "type": "object",
      "description": "Domain-scoped RGB projections",
      "patternProperties": {
        "^[a-z]+\\.[a-z]+$": {
          "type": "string",
          "pattern": "^#[0-9A-Fa-f]{6}$",
          "description": "RGB hex color for domain (e.g., '#FF00FF')"
        }
      },
      "examples": [
        {
          "color.light": "#FF00FF",
          "color.paint": "#800080"
        }
      ]
    },
    "policyUri": {
      "type": "string",
      "format": "uri",
      "description": "Optional URI for governance policy (ipfs://, https://)"
    },
    "license": {
      "type": "string",
      "description": "Optional license identifier (e.g., 'MIT', 'Apache-2.0')"
    },
    "attester": {
      "type": "string",
      "description": "Optional attester address or identifier"
    },
    "evidenceUri": {
      "type": "string",
      "format": "uri",
      "description": "Optional URI for external evidence"
    },
    "topicId": {
      "type": "string",
      "pattern": "^0\\.0\\.[0-9]+$",
      "description": "HCS topic ID for proof submission"
    },
    "agent": {
      "type": "string",
      "description": "Optional agent identifier or version"
    },
    "ts": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp"
    },
    "signer": {
      "type": "string",
      "pattern": "^0x[0-9a-fA-F]{40}$",
      "description": "EVM address of manifest signer/submitter"
    },
    "nonce": {
      "type": "integer",
      "minimum": 0,
      "description": "Nonce for replay protection (optional)"
    },
    "attestation": {
      "type": "string",
      "description": "Optional signature or attestation over canonical manifest"
    }
  },
  "additionalProperties": false
}
